---
title: "Rmd File"
author: "Emily Daubenspeck"
date: "November 14, 2018"
output: pdf_document
---

## Instructions

*Make at least 5 images of your data, noting what you have learned about your data as a result of creating these images

*Create numerical summaries for at least 4 variables in your dataset. 

*What did you learn about your data as a result of creating these summaries?

Attempt to implement at least 3 versions of your team's highest priority method as outlined in the revised proposal. This could look like:

If you are focusing on regression, you could:
Run a few bivariate regression models
Try a few subset selection methods
Experiment with ridge regression and lasso

If you are prioritizing classification, you could try kNN, QDA, LDA, and Logistic regression (and comparing the assumptions violated in each)
If your plan was to do classification and then regression, could the class on November 12 provide inspiration?
Leverage cross-validation with different number of folds to tune various hyper-parameters (such as penalties or the k in kNN).

```{r, message = FALSE, warning = FALSE}
## reading in data files, joining to access prescribing behavior (response vars)
library(tidyverse)
library(corrplot)
County_Drug <- read_csv("County_Drug.csv")
prescribing_behavior <- read_csv("293 COUNTY DATA/prescribing_behavior.csv") %>%
  mutate(county_id = paste0("05000US", FIPS)) %>%
  subset(select = -c(`State Name`, `State Abbreviation`, `County Name`, `FIPS`))
colnames(prescribing_behavior) <- c("part_d_prescribers", "part_d_opiod_prescribers", "opiod_claims", "extended_release_opioid_claims", "overall_claims", "opioid_prescribing_rate", "extended_release_prescription_rate", "change_in_rate", "county_id")

## joining data sets
working_data <- County_Drug %>%
  inner_join(prescribing_behavior, by = "county_id") %>%
  na.omit() %>%
  subset(select = -c(X1))

```

```{r, messaage = FALSE, warning = FALSE}

## some visualizations

ggplot(working_data, aes(x = opioid_prescribing_rate)) + 
  geom_histogram()

ggplot(working_data, aes(x = prescriber_immunity_criminal, fill = state_legislature)) + 
  geom_bar()

ggplot(working_data, aes(x = num_exchange, y = opioid_prescribing_rate)) + 
  geom_point()

numeric_only <- working_data[, sapply(working_data, is.numeric)] %>%
  select(unemployment_rate, hs_graduation_rate, male_proportion, female_proportion, num_exchange, poverty_rate, opioid_prescribing_rate, change_in_rate)
cor_data <- cor(numeric_only) %>%
  round(2)
corrplot(cor_data, method = "circle")

ggplot(working_data, aes(x = change_in_rate, y = opioid_prescribing_rate)) + 
  geom_point()
## Note: weird upper outlier is a county in WA (Skamania) that had an increase in prescribing rate equal to the rate it shows now. This indicates that they might not have had data collected in 2013, or they didn't have any prescribers)
```
